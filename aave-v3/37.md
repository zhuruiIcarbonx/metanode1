了解 DeFi 借贷中的准备金因素
在去中心化金融 (DeFi) 借贷协议中，准备金率是一个关键参数，它决定了借款人支付的利息如何分配。具体来说，它代表了借款利息中由协议本身保留的一定比例，而不是分配给贷款人（供应商）。

当用户从借贷池借入资产并随后偿还贷款时，他们还会支付额外的利息。准备金因子决定了从这些利息中抽取多少比例会转入协议的储备金。这些储备金通常由指定的智能合约管理，有时也称为“收集者合约”。扣除准备金因子和其他潜在调整后，剩余的利息通常会分配给为该特定资产提供流动性的用户。这种机制允许协议随着时间的推移积累自身的资本。

确定准备金系数：用户界面示例
许多 DeFi 借贷协议（例如 Aave）在其用户界面中提供了每种资产的准备金率透明度。例如，在查看特定资产的“借款信息”时，您可能会发现一个详细说明“收款人信息”的部分。

在此部分中，有如下行项目：

准备金率：15.00%

会清晰地表明协议的份额。这意味着，对于该特定资产，所有借贷利息的 15% 将被协议捕获并添加到其储备中。因此，剩余的 85%（在扣除任何其他协议特定的计算或费用之前）将作为收益分配给向借贷池提供该资产的借贷者。

储备因子的实际应用：Aave V3 代码分析
为了更深入地了解储备因子的机制，我们可以研究其在 Aave V3 等著名 DeFi 协议中的实现。

智能合约上下文

利率计算的逻辑，包括储备因子的应用，通常封装在特定的智能合约中。在 Aave V3 中，一个用于此目的的关键合约是DefaultReserveInterestRateStrategyV2.sol（通常位于类似 的路径中aave-v3-origin/src/contracts/misc/DefaultReserveInterestRateStrategyV2.sol）。该合约负责确定 Aave 协议中借入和供应资产的动态利率。

函数calculateInterestRates​

该策略合约的核心函数是calculateInterestRates。其签名为：

函数 calculateInterestRates（DataTypes.CalculateInterestRatesParams内存参数）外部 视图 虚拟 覆盖 返回（uint256，uint256）
此函数接受各种参数，这些参数分组在 内DataTypes.CalculateInterestRatesParams memory params。这些参数包括关键数据点，例如资产的总债务、可用流动性，以及reserveFactor该资产的 。该函数的目的是计算并返回两个主要值：

当前流动性率（转化为供应 APY）。

当前可变借款利率（转换为借款 APY）。

用准备金率计算供给率

储备系数的应用最明显体现在currentLiquidityRate（支付给供应商的利率）的推导上。在函数的末尾calculateInterestRates，计算过程概念上如下：

// ...
// 先前的计算确定了 vars.currentVariableBorrowRate（借款人的利率）
// 和 vars.supplyUsageRatio（资产利用率）。
// ...
​
// 计算流动性率（供应率）
vars.currentLiquidityRate = vars
    .currentVariableBorrowRate // 从借款利率开始
    .rayMul(vars.supplyUsageRatio) // 乘以利用率
    .percentMul(PercentageMath.PERCENTAGE_FACTOR - params.reserveFactor); // 应用储备因子
​
// 函数返回 (vars.currentLiquidityRate, vars.currentVariableBorrowRate)
返回（vars.currentLiquidityRate，vars.currentVariableBorrowRate）；
计算的详细分类：

让我们分析一下纳入准备金率的关键路线：

vars.currentVariableBorrowRate：这是借款人为资产支付的现行利率。

.rayMul(vars.supplyUsageRatio)：currentVariableBorrowRate然后将 乘以supplyUsageRatio（通常称为利用率）。利用率通常计算为totalBorrows / (totalBorrows + availableLiquidity)或totalBorrows / totalSupplied。该乘积实际上代表了在考虑协议份额之前，池子每单位总供应量所获得的总利息。rayMul是 DeFi 中常见的高精度乘法函数。

.percentMul(PercentageMath.PERCENTAGE_FACTOR - params.reserveFactor)：这是储备系数直接影响供应商收益的地方。

PercentageMath.PERCENTAGE_FACTOR：这是一个代表 100% 的常数。例如，如果其值为10000，则100代表 1%。

params.reserveFactor：这是正在处理的资产的特定储备因子（例如，1500如果因子为 15% 且PERCENTAGE_FACTOR为10000）。

(PercentageMath.PERCENTAGE_FACTOR - params.reserveFactor)：此减法计算的是协议未保留的利息部分。对于 15% 的准备金率，结果为(100% - 15%) = 85%。

然后，该.percentMul函数将先前计算的利息（借入利率按使用率缩放）乘以该(100% - Reserve Factor)百分比。这确保仅将生成的利息中指定部分分配给currentLiquidityRate供应商。该Reserve Factor百分比隐含地是协议保留的部分。

连接点：准备金率、利率和利用率
准备金率并非孤立运作。它是一个动态系统的组成部分，涉及借贷协议中的几个关键金融概念：

借款利息：这是协议及其供应商的基本收入来源。它是用户为借入资产服务支付的费用。

利用率（supplyUsageRatio）：该指标反映的是当前借入资产占总供给资产的比例。较高的利用率通常表明借入资产的需求强劲。大多数利率模型的设计都考虑到，较高的利用率会导致借款人和供应商的利率上升（在一定阈值内），因为这意味着可用资本的稀缺性。

准备金因子：如上所述，这是协议在借款利息中所占的指定份额。它直接减少了可供分配给供应商的利息金额。

供给利率 ( currentLiquidityRate)：这是用户向协议借出（供应）资产所获得的收益率 (APY)。它源自借款人支付的利息，并根据利用率进行调整，更重要的是，还要考虑到协议已根据准备金系数提取其份额。在其他条件相同的情况下，准备金系数越高，供给 APY 越低。

协议储备库的战略重要性
协议实施储备因子有几个战略原因，主要围绕构建可持续且有弹性的生态系统：

国库积累：最直接的结果是协议自身国库或储备的增长。这些资金是由协议拥有和控制的资产（通常通过其治理机制）。

风险缓解：储备金可以作为缓冲，弥补潜在损失。在 DeFi 领域，这可能包括因智能合约漏洞、预言机故障或市场大幅下跌导致的坏账等情况。

资助开发和运营：累积的储备可用于资助持续开发、安全审计、运营费用以及对核心开发团队的贡献。

生态系统增长和激励：可以部署储备来促进生态系统增长，例如为基于协议的第三方开发者提供资金补助、流动性挖掘计划（尽管与储备因素的直接影响不同）或其他社区计划。

可配置性和治理：储备因子通常不是静态值。它通常可以根据每个资产进行配置，并可由协议的治理代币持有者进行调整，从而允许社区根据不断变化的市场条件或战略重点调整协议的收入模型。

总而言之，准备金因子是 DeFi 借贷协议代币经济学和财务健康的重要组成部分，使其能够获取价值、管理风险并为其长期生存能力和增长提供资金。
