了解 Aave V3 的 aTokens 和可变债务代币
当用户与领先的去中心化金融 (DeFi) 借贷平台 Aave V3 协议交互时，他们会收到代表其持仓的特定类型的代币。本课程将深入探讨这些代币的性质，具体来说，它们aTokens是在提供资产时收到的，以及variable debt tokens在以浮动利率借入资产时发行的。这两种代币类型的一个关键特征是它们都是“rebase 代币”，我们将详细探讨这个概念，包括如何在 Etherscan 等区块浏览器上观察它们的行为。

aTokens：您的有息抵押品代表

当您向 Aave V3 市场（例如以太坊上的市场）提供资产（例如 DAI 稳定币）时，您将获得相应的aToken。例如，在以太坊 Aave V3 市场上提供 DAI 将会aEthDAI向您的钱包铸造代币。这些代币aTokens主要有两个功能：它们代表您对所提供抵押品的所有权，并且至关重要的是，它们会随着时间的推移累积利息。 的神奇之处aTokens在于其 rebase 特性：您钱包中这些代币的余额会随着利息的累积而直接增加，而无需在您初始供应量之外进行任何新的交易。

可变债务代币：追踪您的累计借款金额

相反，当您从 Aave V3 借入资产（例如 WETH）并选择浮动利率时，协议会将款项发放variable debt tokens到您的钱包。例如，在以太坊 Aave V3 上借入 WETH 会让您收到Aave Ethereum Variable Debt WETH代币。这些代币代表您对协议的未偿债务。与 类似aTokens，variable debt tokens也进行 rebase。它们在您钱包中的余额会随着时间的推移而增加，反映出您借入金额的累积利息。这意味着您欠的代币总量会随着利息的累积而增加。

Aave V3 中代币变基机制
“重新调整代币”的概念对于理解 Aave V3 如何在代币层面管理供应商和借款人的利益至关重要。

定义变基代币

变基代币是一种加密货币，其流通供应量通过算法调整，从而导致每个持有者的代币余额发生变化。与标准 ERC-20 代币（其余额只能通过显式的 、 或 交易进行更改）不同，mint变burn基transfer代币的余额可以根据其智能合约中预定义的逻辑自动更改。

Aave V3 中的 rebasing：反映利息动态

在Aave V3生态中，巧妙地运用了rebasing机制，体现了利息的持续累积。

对于持有的供应商aTokens，其余额aTokens会随着时间的推移而直接增加。这种增长代表了其所提供资本所获得的利息。

对于持有 的借款人variable debt tokens来说，这些代币的余额也会增加。这种增长意味着他们未偿债务的利息在累积，实际上表明总欠款金额在增加。

这种对代币余额的利息直接反映简化了用户在 Aave 协议中追踪其收入或负债的方式。

Aave V3 代币架构：代理合约
aTokensAave V3 中的和均variable debt tokens使用称为代理合约的通用智能合约模式实现。

理解代理合约

代理合约是一种将其调用委托给另一个合约（称为实现合约）的合约。当您与代币地址（代理合约）交互时，您的交互将被转发到包含实际逻辑的底层实现合约。

可升级性的优势

这种代理模式的主要优势在于可升级性。Aave 开发团队可以部署新版本的代币逻辑（一个新的实现合约），并更新代理使其指向新的逻辑，而无需更改用户和其他智能合约交互的实际代币地址。这允许在维护稳定的合约接口的同时修复错误并增强功能。

与 Etherscan 上的代理合约进行交互

在 Etherscan 等区块浏览器上检查这些 Aave V3 代币合约时，这种代理架构具有一定的含义。要查看实际功能、读取数据或检查代币逻辑的源代码，您需要导航到“合约”选项卡，然后选择“以代理读取”或“以代理写入”子选项卡。这确保您正在与底层实现合约进行交互，而不仅仅是代理外壳。

在 Etherscan 上演示 aToken 的 Rebasing：供应 DAI
aTokens让我们通过检查 Etherscan 上的供应交易来说明重新定基的性质。

假设有用户5.103091641659537865 DAI在以太坊上向 Aave V3 提供资金。Etherscan 交易详情将显示：

已转移的 ERC-20 代币：

用户Sent：5.103091641659537865 Dai Stablecoin (DAI)Aave V3 合约。

用户Received：（5.103091641659537865 Aave Ethereum DAI V3这是令aEthDAI牌）。

可能存在内部转移，其中 Aave V3 也“接收” DAI。

至关重要的是，有一个铸造事件aEthDAI：（Sent从空地址0x00...000）5.103091641659537865 Aave Ethereum DAI V3到用户的地址。

检查aEthDAI合同（例如0x018008bfb33d285247A21d44E50697654f754e63）

导航到aEthDAIEtherscan 上的代币合约地址。

点击“合约”选项卡，然后点击“代码”。您可能会看到它被标识为InitializableImmutableAdminUpgradeabilityProxy或类似的代理合约。

要与其实际逻辑进行交互，请单击“读取为代理”选项卡。

找到该balanceOf(address user)功能（通常是列表中的功能#9）。

在字段中输入用户的钱包地址（例如0xd24cBa75...f49E）user，然后点击“查询”。

观察重新定基的效果：

初始余额查询：您可能会看到类似的结果uint256 : 5149430588809018496（代表初始 5.103... aEthDAI，但以其最小面额）。

后续余额查询：在没有新的链上交易（没有新的存入、提现或转账）的情况下，等待一段时间后balanceOf再次点击功能上的“查询”。您将看到余额略有增加，例如uint256 : 5149430837216445173。

在另一个短暂的时间间隔后进行第三次查询可能会显示更高的余额，例如uint256 : 5149430936579415844。

这种无需任何相应交易的增量结果balanceOf，直接体现了 的重新调整基数特性aToken。余额会随着利息的累积而自动增长。

在 Etherscan 上演示可变债务代币的重新定价：借入 WETH
当您借入资产时，相同的重新调整原则也适用于可变债务代币。

假设有一笔交易，用户使用浮动利率从 Aave V3 借入 WETH。Etherscan 可能会显示：

内部交易：用户Received一定数量的 ETH（例如0.000985253251077848 ETH），然后通常将其包装成 WETH。

已转移的 ERC-20 代币：

用户Received：（0.000985253251077848 Wrapped Ether (WETH)实际借入的资产）。

用户还Received：（0.000985253251077848 Aave Ethereum Variable Debt WETH债务代币）。

此债务代币从 Null 地址铸造到用户的地址。

检查可变债务 WETH 合约（例如0xeA51d7853EEFb32b6e06b1C12E6dCCA88Be0ffFE）

转到 Etherscan 上的可变债务 WETH 代币合约地址。

点击“合约”选项卡，然后点击“代码”。再次，你会看到它是一个代理合约（例如InitializableImmutableAdminUpgradeabilityProxy）。

单击“读取为代理”选项卡。

找到balanceOf(address user)函数（通常是函数#8）。

输入用户的地址，点击“查询”。

观察债务积累：

初始债务余额：查询可能会返回初始债务余额，例如uint256 : 1771533521731055（代表最小单位的初始 0.000985...WETH 债务）。

后续债务余额查询：过一段时间后，balanceOf再次查询，没有任何还款或进一步借款，将显示增加的值，例如uint256 : 1771533556084135。

第三个查询可能会产生uint256 : 1771533573260675。

可变债务代币余额的不断增加，意味着借款金额的利息不断累积。你的债务会随着时间的推移而增长，这直接体现在债务代币的重新定价特性上。

关键要点：aTokens、可变债务代币和 Rebasing
了解 Aave V3 中代币的行为对于有效管理你的 DeFi 仓位至关重要。以下是关键点：

提供资产：当您向 Aave V3 提供资产时，您将收到相应的aTokens（例如aEthDAI）。这些代币代表您存入的本金加上应计利息。

借入资产（浮动利率）：当您以浮动利率从 Aave V3 借入资产时，您将获得variable debt tokens（例如Aave Ethereum Variable Debt WETH）。这些代币代表您未偿还的贷款本金加上累计利息。

重新定价的性质：和 都是aTokens重新variable debt tokens定价代币。这意味着它们在您钱包中的余额会随着时间的推移自动变化，以反映利息的应计（对于aTokens）或利息的累积（对于variable debt tokens），而无需进行新的铸造、销毁或转移交易。

代理合约：这些 Aave V3 代币以代理合约的形式实现。这允许在不更改代币地址的情况下进行协议升级。在 Etherscan 上与它们交互时，请记住使用“合约”选项卡下的“以代理身份读取”（或“以代理身份写入”）选项来查看底层逻辑和状态。

balanceOf()函数：这些代币合约上的函数balanceOf(address)将返回当前的最新值。对于aTokens，这是您的本金加上所有已赚取的利息。对于variable debt tokens，这是您的未偿债务，包括所有累计利息。

动态余额：balanceOf()由于利息计算的连续性、实时性和重新定基机制，在 Etherscan 上连续多次查询该函数可能会显示略有不同的值。

通过掌握这些概念，您可以更好地解释您的 Aave V3 头寸，并了解如何在此高级 DeFi 协议中直接在代币级别管理利息。
