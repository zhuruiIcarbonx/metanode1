
	
# 一、redis 槽是干什么的


Redis 槽（Slot）是 Redis Cluster 分区机制的核心概念，主要作用是将数据分散存储在不同的节点上，实现分布式存储和负载均衡。以下是关键点：

1. **固定数量分片**
   - Redis Cluster 将所有数据划分为 16384 个哈希槽（0-16383）
   - 每个键通过 `CRC16(key) % 16384` 计算所属槽位

2. **数据分布原理**
   - 集群启动时管理员可以手动分配槽到不同节点
   - 官方推荐每个主节点处理的槽数量尽量均衡
   - 示例分配：节点A负责 0-5000，节点B 5001-10000，节点C 10001-16383

3. **集群操作特征**
   - 客户端可直接连接任意节点访问数据
   - 当访问的key不在当前节点时，返回 `MOVED` 重定向响应
   - 支持重新分片（resharding），槽可在线迁移

4. **特殊槽位**
   - 槽0xFFFF（16383）保留用于集群心跳检测
   - 迁移中的槽会临时返回 `ASK` 重定向

5. **实际影响**
   - 多键操作要求所有key必须属于同一槽（可用哈希标签强制同槽）
   - 节点故障时，其负责的槽会被从节点接管
   - 槽分配信息通过Gossip协议在集群内同步

这种设计使Redis Cluster能实现：
- 水平扩展至最多1000个节点
- 自动故障转移
- 无代理的直连式访问
